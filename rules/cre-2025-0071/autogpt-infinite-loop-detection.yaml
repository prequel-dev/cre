rules:
  - metadata:
      id: 6qHwZYugnnmUoB7FwVJdm7
      kind: community
    cre:
      id: CRE-5Ud1RZxGC5LJQnVpAkV11A
      severity: 1
      title: AutoGPT Agent Infinite Loop Detection
      category: asynchronous-task-problem
      author: CRE Community
      description: |
        AutoGPT agent has entered an infinite loop, repeatedly executing the same or similar tasks without making progress.
      cause: |
        This typically occurs when:
        1. The agent's task lacks clear success criteria
        2. The agent gets stuck in a recursive thought pattern
        3. External state isn't being properly updated between iterations
        4. The agent fails to recognize task completion
      impact: |
        - Wastes computational resources (CPU/memory)
        - Prevents the agent from making progress on its task
        - May lead to unexpected cloud costs if running in a cloud environment
        - Can cause cascading failures in dependent systems
      impactScore: 9
      tags:
        - critical-failure
        - cpu-memory-exhaustion
        - performance
      mitigation: |
        - Implement maximum iteration limits in the agent's execution loop
        - Add progress tracking to detect repetitive behavior
        - Improve task decomposition and success criteria
        - Add circuit breakers to terminate unproductive executions
        - Monitor for excessive resource usage patterns
      mitigationScore: 8
      references:
        - https://docs.agpt.co/agent-failures#infinite-loops
      applications:
        - name: "autogpt"
          version: ">=0.4.0"
    rule:
      sequence:
        event:
          source: cre.log.application
        window: 5m
        order:
          - regex: ".*\\[INFO\\] Executing step \\d+ with command: .*"
          - regex: ".*\\[INFO\\] Agent entering loop with same state: .*"
            count: 2
            within: 5m
        negate:
          - regex: ".*Task completed successfully.*"
            window: 30s
          - regex: ".*Agent is making progress.*"
            window: 1m
